<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huawei.aitransform.mapper.EntryLevelManagerMapper">

    <!-- ç»“æžœæ˜ å°„ -->
    <resultMap id="BaseResultMap" type="com.huawei.aitransform.entity.EntryLevelManager">
        <id column="employee_appointment_id" property="employeeAppointmentId" jdbcType="BIGINT"/>
        <result column="employee_number" property="employeeNumber" jdbcType="VARCHAR"/>
        <result column="organization_code" property="organizationCode" jdbcType="VARCHAR"/>
        <result column="organization_name_cn" property="organizationNameCn" jdbcType="VARCHAR"/>
        <result column="job_code" property="jobCode" jdbcType="VARCHAR"/>
        <result column="job_name_cn" property="jobNameCn" jdbcType="VARCHAR"/>
        <result column="start_date" property="startDate" jdbcType="TIMESTAMP"/>
        <result column="end_date" property="endDate" jdbcType="TIMESTAMP"/>
        <result column="status" property="status" jdbcType="VARCHAR"/>
        <result column="l1_department_code" property="l1DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l2_department_code" property="l2DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l3_department_code" property="l3DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l4_department_code" property="l4DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l5_department_code" property="l5DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l6_department_code" property="l6DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l7_department_code" property="l7DepartmentCode" jdbcType="VARCHAR"/>
        <result column="l1_department_cn_name" property="l1DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="l2_department_cn_name" property="l2DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="l3_department_cn_name" property="l3DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="l4_department_cn_name" property="l4DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="l5_department_cn_name" property="l5DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="l6_department_cn_name" property="l6DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="l7_department_cn_name" property="l7DepartmentCnName" jdbcType="VARCHAR"/>
        <result column="position_name_cn" property="positionNameCn" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- æŸ¥è¯¢æ‰€æœ‰çŠ¶æ€ä¸ºæœ‰æ•ˆçš„PLå’ŒTMäººå‘˜ -->
    <select id="selectValidPlAndTm" resultMap="BaseResultMap">
        SELECT s.* 
        FROM t_entry_level_manager_sync s 
        JOIN t_employee_sync t ON t.employee_number = s.employee_number 
        WHERE s.job_name_cn IN ('PL', 'TM')
          AND t.period_id = '20251222'
          AND s.l1_department_code = '075774'
          AND s.status = 'Y'
        GROUP BY s.employee_number
    </select>

    <!-- æŸ¥è¯¢æ‰€æœ‰ä»»æœŸç»“æŸçš„PLå’ŒTM -->
    <select id="selectExpiredPlAndTm" resultMap="BaseResultMap">
        SELECT s.* 
        FROM t_entry_level_manager_sync s 
        JOIN t_employee_sync t ON t.employee_number = s.employee_number 
        WHERE s.job_name_cn IN ('PL', 'TM')
          AND t.period_id = '20251222'
          AND s.l1_department_code = '075774'
          AND s.status = 'N'
        GROUP BY s.employee_number
    </select>

    <!-- æ ¹æ®employee_appointment_idæŸ¥è¯¢è®°å½• -->
    <select id="selectByEmployeeAppointmentId" resultMap="BaseResultMap">
        SELECT * 
        FROM t_entry_level_manager 
        WHERE employee_appointment_id = #{employeeAppointmentId}
    </select>

    <!-- æ ¹æ®employee_numberæŸ¥è¯¢è®°å½• -->
    <select id="selectByEmployeeNumber" resultMap="BaseResultMap">
        SELECT * 
        FROM t_entry_level_manager 
        WHERE employee_number = #{employeeNumber}
        LIMIT 1
    </select>

    <!-- æ’å…¥è®°å½• -->
    <insert id="insert" parameterType="com.huawei.aitransform.entity.EntryLevelManager">
        INSERT INTO t_entry_level_manager (
            employee_appointment_id,
            employee_number,
            organization_code,
            organization_name_cn,
            job_code,
            job_name_cn,
            start_date,
            end_date,
            status,
            l1_department_code,
            l2_department_code,
            l3_department_code,
            l4_department_code,
            l5_department_code,
            l6_department_code,
            l7_department_code,
            l1_department_cn_name,
            l2_department_cn_name,
            l3_department_cn_name,
            l4_department_cn_name,
            l5_department_cn_name,
            l6_department_cn_name,
            l7_department_cn_name,
            position_name_cn
        ) VALUES (
            #{employeeAppointmentId},
            #{employeeNumber},
            #{organizationCode},
            #{organizationNameCn},
            #{jobCode},
            #{jobNameCn},
            #{startDate},
            #{endDate},
            #{status},
            #{l1DepartmentCode},
            #{l2DepartmentCode},
            #{l3DepartmentCode},
            #{l4DepartmentCode},
            #{l5DepartmentCode},
            #{l6DepartmentCode},
            #{l7DepartmentCode},
            #{l1DepartmentCnName},
            #{l2DepartmentCnName},
            #{l3DepartmentCnName},
            #{l4DepartmentCnName},
            #{l5DepartmentCnName},
            #{l6DepartmentCnName},
            #{l7DepartmentCnName},
            #{positionNameCn}
        )
    </insert>

    <!-- æ›´æ–°è®°å½•ï¼ˆæ ¹æ®employee_appointment_idï¼?-->
    <update id="update" parameterType="com.huawei.aitransform.entity.EntryLevelManager">
        UPDATE t_entry_level_manager
        SET employee_number = #{employeeNumber},
            organization_code = #{organizationCode},
            organization_name_cn = #{organizationNameCn},
            job_code = #{jobCode},
            job_name_cn = #{jobNameCn},
            start_date = #{startDate},
            end_date = #{endDate},
            status = #{status},
            l1_department_code = #{l1DepartmentCode},
            l2_department_code = #{l2DepartmentCode},
            l3_department_code = #{l3DepartmentCode},
            l4_department_code = #{l4DepartmentCode},
            l5_department_code = #{l5DepartmentCode},
            l6_department_code = #{l6DepartmentCode},
            l7_department_code = #{l7DepartmentCode},
            l1_department_cn_name = #{l1DepartmentCnName},
            l2_department_cn_name = #{l2DepartmentCnName},
            l3_department_cn_name = #{l3DepartmentCnName},
            l4_department_cn_name = #{l4DepartmentCnName},
            l5_department_cn_name = #{l5DepartmentCnName},
            l6_department_cn_name = #{l6DepartmentCnName},
            l7_department_cn_name = #{l7DepartmentCnName},
            position_name_cn = #{positionNameCn}
        WHERE employee_appointment_id = #{employeeAppointmentId}
    </update>

    <!-- æ ¹æ®employee_numberæ›´æ–°è®°å½• -->
    <update id="updateByEmployeeNumber" parameterType="com.huawei.aitransform.entity.EntryLevelManager">
        UPDATE t_entry_level_manager
        SET employee_appointment_id = #{employeeAppointmentId},
            organization_code = #{organizationCode},
            organization_name_cn = #{organizationNameCn},
            job_code = #{jobCode},
            job_name_cn = #{jobNameCn},
            start_date = #{startDate},
            end_date = #{endDate},
            status = #{status},
            l1_department_code = #{l1DepartmentCode},
            l2_department_code = #{l2DepartmentCode},
            l3_department_code = #{l3DepartmentCode},
            l4_department_code = #{l4DepartmentCode},
            l5_department_code = #{l5DepartmentCode},
            l6_department_code = #{l6DepartmentCode},
            l7_department_code = #{l7DepartmentCode},
            l1_department_cn_name = #{l1DepartmentCnName},
            l2_department_cn_name = #{l2DepartmentCnName},
            l3_department_cn_name = #{l3DepartmentCnName},
            l4_department_cn_name = #{l4DepartmentCnName},
            l5_department_cn_name = #{l5DepartmentCnName},
            l6_department_cn_name = #{l6DepartmentCnName},
            l7_department_cn_name = #{l7DepartmentCnName},
            position_name_cn = #{positionNameCn}
        WHERE employee_number = #{employeeNumber}
    </update>

    <!-- æ‰¹é‡æ’å…¥æˆ–æ›´æ–°ï¼ˆæ ¹æ®employee_numberï¼Œä½¿ç”¨ON DUPLICATE KEY UPDATEï¼?-->
    <!-- æ³¨æ„ï¼šéœ€è¦ç¡®ä¿employee_numberå­—æ®µæœ‰å”¯ä¸€ç´¢å¼•ï¼Œå¦åˆ™ON DUPLICATE KEY UPDATEä¸ä¼šç”Ÿæ•ˆ -->
    <insert id="batchInsertOrUpdate" parameterType="java.util.List">
        INSERT INTO t_entry_level_manager (
            employee_appointment_id,
            employee_number,
            organization_code,
            organization_name_cn,
            job_code,
            job_name_cn,
            start_date,
            end_date,
            status,
            l1_department_code,
            l2_department_code,
            l3_department_code,
            l4_department_code,
            l5_department_code,
            l6_department_code,
            l7_department_code,
            l1_department_cn_name,
            l2_department_cn_name,
            l3_department_cn_name,
            l4_department_cn_name,
            l5_department_cn_name,
            l6_department_cn_name,
            l7_department_cn_name,
            position_name_cn
        ) VALUES
        <foreach collection="list" item="item" separator=",">
            (
                #{item.employeeAppointmentId},
                #{item.employeeNumber},
                #{item.organizationCode},
                #{item.organizationNameCn},
                #{item.jobCode},
                #{item.jobNameCn},
                #{item.startDate},
                #{item.endDate},
                #{item.status},
                #{item.l1DepartmentCode},
                #{item.l2DepartmentCode},
                #{item.l3DepartmentCode},
                #{item.l4DepartmentCode},
                #{item.l5DepartmentCode},
                #{item.l6DepartmentCode},
                #{item.l7DepartmentCode},
                #{item.l1DepartmentCnName},
                #{item.l2DepartmentCnName},
                #{item.l3DepartmentCnName},
                #{item.l4DepartmentCnName},
                #{item.l5DepartmentCnName},
                #{item.l6DepartmentCnName},
                #{item.l7DepartmentCnName},
                #{item.positionNameCn}
            )
        </foreach>
        ON DUPLICATE KEY UPDATE
            employee_appointment_id = VALUES(employee_appointment_id),
            organization_code = VALUES(organization_code),
            organization_name_cn = VALUES(organization_name_cn),
            job_code = VALUES(job_code),
            job_name_cn = VALUES(job_name_cn),
            start_date = VALUES(start_date),
            end_date = VALUES(end_date),
            status = VALUES(status),
            l1_department_code = VALUES(l1_department_code),
            l2_department_code = VALUES(l2_department_code),
            l3_department_code = VALUES(l3_department_code),
            l4_department_code = VALUES(l4_department_code),
            l5_department_code = VALUES(l5_department_code),
            l6_department_code = VALUES(l6_department_code),
            l7_department_code = VALUES(l7_department_code),
            l1_department_cn_name = VALUES(l1_department_cn_name),
            l2_department_cn_name = VALUES(l2_department_cn_name),
            l3_department_cn_name = VALUES(l3_department_cn_name),
            l4_department_cn_name = VALUES(l4_department_cn_name),
            l5_department_cn_name = VALUES(l5_department_cn_name),
            l6_department_cn_name = VALUES(l6_department_cn_name),
            l7_department_cn_name = VALUES(l7_department_cn_name),
            position_name_cn = VALUES(position_name_cn)
    </insert>

    <!-- æŸ¥è¯¢ç›®æ ‡è¡¨ä¸­æ‰€æœ‰çš„employee_number -->
    <select id="selectAllEmployeeNumbers" resultType="java.lang.String">
        SELECT DISTINCT employee_number 
        FROM t_entry_level_manager 
        WHERE employee_number IS NOT NULL 
          AND employee_number != ''
    </select>

    <!-- æ ¹æ®employee_numberåˆ é™¤è®°å½• -->
    <delete id="deleteByEmployeeNumber">
        DELETE FROM t_entry_level_manager 
        WHERE employee_number = #{employeeNumber}
    </delete>

    <!-- æ‰¹é‡æ ¹æ®employee_numberåˆ é™¤è®°å½• -->
    <delete id="batchDeleteByEmployeeNumbers" parameterType="java.util.List">
        DELETE FROM t_entry_level_manager 
        WHERE employee_number IN
        <foreach collection="list" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

</mapper>


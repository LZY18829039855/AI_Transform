# 干部认证达标更新接口文档

## 1. 接口概述

### 1.1 接口名称
干部认证达标更新接口

### 1.2 接口描述
更新L2、L3干部的AI认证达标情况，根据干部是否持有AI专业级证书以及非软件类干部是否通过专业级科目二考试来判断是否达标，并更新干部表中的`is_cert_standard`字段。

### 1.3 接口路径
```
POST /expert-cert-statistics/update-cadre-cert-standard
```

### 1.4 请求方式
POST

---

## 2. 更新规则

### 2.1 认证达标判断规则

1. **持有AI专业级证书**：
   - 所有干部（软件类和非软件类）如果持有AI专业级证书，视为认证达标
   - 将`is_cert_standard`字段更新为1

2. **非软件类干部通过专业级科目二考试**：
   - 非软件类干部如果通过了专业级科目二考试，视为认证达标
   - 专业级科目二考试代码：`EXCN022303075ZA2E`（需在`t_exam_record`表中存在该`exam_code`且`is_pass`为1的记录）
   - 将`is_cert_standard`字段更新为1

### 2.2 更新逻辑说明

- 接口会先重置所有L2、L3干部的`is_cert_standard`字段为0
- 然后根据上述规则判断每个干部是否达标
- 对于达标的干部，将`is_cert_standard`字段更新为1
- 对于不达标的干部，`is_cert_standard`字段保持为0

---

## 3. 请求参数

### 3.1 请求头

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Content-Type | String | 是 | application/json |

### 3.2 请求体

该接口无需请求体参数。

### 3.3 请求示例

```http
POST /expert-cert-statistics/update-cadre-cert-standard
Content-Type: application/json
```

---

## 4. 响应参数

### 4.1 响应结构

```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "success": true,
    "message": "更新成功",
    "totalCount": 150,
    "certQualifiedCount": 120,
    "certUnqualifiedCount": 30,
    "updatedCertCount": 120,
    "l2CertQualifiedCount": 60,
    "l2CertUnqualifiedCount": 15,
    "l3CertQualifiedCount": 60,
    "l3CertUnqualifiedCount": 15
  }
}
```

### 4.2 响应字段说明

| 字段名 | 类型 | 说明 |
|--------|------|------|
| code | Integer | 响应状态码，200表示成功 |
| message | String | 响应消息 |
| data | Object | 响应数据对象 |
| data.success | Boolean | 更新是否成功 |
| data.message | String | 更新结果消息 |
| data.totalCount | Integer | L2、L3干部总数 |
| data.certQualifiedCount | Integer | 认证达标的干部总数 |
| data.certUnqualifiedCount | Integer | 认证不达标的干部总数 |
| data.updatedCertCount | Integer | 实际更新的干部数量 |
| data.l2CertQualifiedCount | Integer | L2认证达标的干部数量 |
| data.l2CertUnqualifiedCount | Integer | L2认证不达标的干部数量 |
| data.l3CertQualifiedCount | Integer | L3认证达标的干部数量 |
| data.l3CertUnqualifiedCount | Integer | L3认证不达标的干部数量 |

---

## 5. 响应示例

### 5.1 成功响应

```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "success": true,
    "message": "更新成功",
    "totalCount": 150,
    "certQualifiedCount": 120,
    "certUnqualifiedCount": 30,
    "updatedCertCount": 120,
    "l2CertQualifiedCount": 60,
    "l2CertUnqualifiedCount": 15,
    "l3CertQualifiedCount": 60,
    "l3CertUnqualifiedCount": 15
  }
}
```

### 5.2 失败响应

```json
{
  "code": 500,
  "message": "更新失败：系统异常信息",
  "data": null
}
```

---

## 6. 错误码说明

| 错误码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 500 | 服务器内部错误 |

---

## 7. 业务逻辑说明

### 7.1 数据查询范围

- 仅处理L2、L3成熟度的干部
- 查询所有L2、L3干部及其职位类、专业级证书持有情况、专业级科目二通过情况

### 7.2 认证达标判断流程

1. **判断是否持有AI专业级证书**：
   - 如果干部持有AI专业级证书（`hasProfessionalCert = 1`），则视为达标

2. **判断非软件类干部是否通过专业级科目二**：
   - 对于非软件类干部，如果通过了专业级科目二考试（`exam_code = 'EXCN022303075ZA2E'`且`is_pass = 1`），则视为达标

3. **更新字段**：
   - 满足任一条件的干部，将`is_cert_standard`字段更新为1
   - 不满足条件的干部，`is_cert_standard`字段保持为0（已重置）

### 7.3 数据更新流程

1. 查询所有L2、L3干部信息
2. 重置所有L2、L3干部的`is_cert_standard`字段为0
3. 遍历每个干部，根据规则判断是否达标
4. 批量更新达标干部的`is_cert_standard`字段为1
5. 返回更新结果统计信息

---

## 8. 注意事项

1. 该接口会批量更新所有L2、L3干部的认证达标状态，请谨慎调用
2. 接口执行前会先重置所有干部的`is_cert_standard`字段为0，然后根据最新数据重新计算
3. 专业级科目二考试代码为`EXCN022303075ZA2E`，需要在`t_exam_record`表中查询
4. 软件类和非软件类干部都可以通过持有AI专业级证书来达标
5. 非软件类干部还可以通过通过专业级科目二考试来达标

---

## 9. 相关接口

- `POST /expert-cert-statistics/update-cadre-standard` - 更新L2、L3干部的AI任职达标情况和认证达标情况（包含任职和认证两个维度的更新）

---

## 10. 版本历史

| 版本 | 日期 | 说明 | 作者 |
|------|------|------|------|
| 1.0 | 2024-XX-XX | 初始版本，新增干部认证达标更新接口 | - |






